<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Trio Manager v5</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Firebase (compat – düz HTML uyumlu) -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <style>
        /* ===== TASARIM BİREBİR – HİÇ DOKUNULMADI ===== */
        :root {
            --primary: #2563eb;
            --whatsapp: #25D366;
            --asset: #7c3aed;
            --maint: #f97316;
            --bg-body: #f1f5f9;
            --bg-card: #ffffff;
            --text-main: #1e293b;
            --text-sub: #64748b;
            --border: #e2e8f0;
            --danger: #ef4444;
            --success: #10b981;
            --radius: 16px;
        }
        body.dark-mode {
            --primary: #3b82f6;
            --asset: #a78bfa;
            --maint: #fdba74;
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --border: #334155;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg-body); color: var(--text-main); padding-bottom: 90px; padding-top: 15px; transition: 0.3s; }
        .app-container { max-width: 600px; margin: 0 auto; padding: 0 15px; }

        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .brand { display: flex; align-items: center; gap: 10px; }
        .brand i { font-size: 24px; color: var(--primary); background: #e0e7ff; padding: 8px; border-radius: 10px; }
        .brand h1 { font-size: 18px; font-weight: 800; line-height: 1.2; }
        .brand h1 span { font-size: 11px; font-weight: 500; color: var(--text-sub); display: block; }
        .head-actions { display: flex; gap: 8px; }
        .btn-icon { background: var(--bg-card); border: 1px solid var(--border); width: 40px; height: 40px; border-radius: 12px; color: var(--text-main); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; }
        .btn-excel-main { background: #10b981; color: white; border: none; font-weight: bold; width: auto; padding: 0 15px; gap: 5px; }

        .stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-bottom: 20px; }
        .stat-item { background: var(--bg-card); padding: 10px 5px; border-radius: var(--radius); text-align: center; border: 1px solid var(--border); }
        .stat-val { font-size: 18px; font-weight: 800; color: var(--primary); display: block; }
        .stat-lbl { font-size: 9px; font-weight: 700; color: var(--text-sub); text-transform: uppercase; }

        .view-section { display: none; animation: fadeIn 0.3s; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .search-box { position: relative; margin-bottom: 15px; }
        .search-box input { width: 100%; padding: 14px 14px 14px 45px; border-radius: 14px; border: 1px solid var(--border); background: var(--bg-card); color: var(--text-main); outline: none; }
        .search-box i { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-sub); }

        .card { background: var(--bg-card); border-radius: var(--radius); padding: 16px; margin-bottom: 12px; border: 1px solid var(--border); position: relative; }
        .card.patient { border-left: 5px solid var(--primary); }
        .card.device { border-left: 5px solid var(--asset); }
        .card.maintenance { border-left: 5px solid var(--maint); background: linear-gradient(to right, #fff7ed, transparent); }

        .card-head { display: flex; justify-content: space-between; align-items: start; margin-bottom: 8px; }
        .c-title { font-weight: 700; font-size: 16px; }
        .c-badge { font-size: 10px; padding: 4px 8px; border-radius: 6px; font-weight: 700; color: white; background: var(--success); }
        .c-badge.red { background: var(--danger); }
        .c-badge.maint { background: var(--maint); }

        .c-info { font-size: 13px; color: var(--text-sub); display: grid; gap: 4px; margin-bottom: 12px; }
        .c-info div { display: flex; align-items: center; gap: 6px; }
        .c-info i { width: 16px; text-align: center; color: var(--primary); }
        .card.device .c-info i { color: var(--asset); }
        .card.maintenance .c-info i { color: var(--maint); }

        .c-actions { display: flex; gap: 8px; border-top: 1px solid var(--border); padding-top: 10px; overflow-x: auto;}
        .btn-act { flex: 1; white-space: nowrap; height: 38px; border-radius: 10px; border: none; font-size: 11px; font-weight: 700; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 4px; padding: 0 10px; }
        .btn-wa-card { background: #dcfce7; color: #15803d; border: 1px solid #bbf7d0; }
        .btn-edit { background: var(--bg-body); color: var(--text-sub); border: 1px solid var(--border); }
        .btn-move { background: #f3e8ff; color: #6b21a8; }
        .btn-fix { background: #ffedd5; color: #c2410c; }
        .btn-del { width: 38px; flex: none; background: #fee2e2; color: #b91c1c; border: 1px solid #fecaca; }

        .modal-overlay { position: fixed; inset:0; background: rgba(0,0,0,0.5); z-index: 200; display: none; align-items: flex-end; justify-content: center; }
        .modal-overlay.open { display: flex; }
        .modal-content { background: var(--bg-card); width: 100%; max-width: 600px; padding: 25px; border-radius: 24px 24px 0 0; animation: slideUp 0.3s; max-height: 85vh; overflow-y: auto; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

        .form-input { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid var(--border); background: var(--bg-body); color: var(--text-main); margin-bottom: 15px; outline: none; }
        .btn-save { width: 100%; padding: 16px; background: var(--primary); color: white; border: none; border-radius: 14px; font-weight: 700; cursor: pointer; }

        .tab-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--bg-card); border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: 10px 0; z-index: 100; }
        .tab-btn { background: none; border: none; display: flex; flex-direction: column; align-items: center; color: var(--text-sub); font-size: 10px; font-weight: 600; cursor: pointer; }
        .tab-btn i { font-size: 22px; margin-bottom: 4px; }
        .tab-btn.active { color: var(--primary); }

        #loader { position: fixed; inset: 0; background: var(--bg-body); z-index: 999; display: flex; justify-content: center; align-items: center; }
        .spinner { width: 40px; height: 40px; border: 4px solid var(--border); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s infinite linear; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>

<body>
<div id="loader"><div class="spinner"></div></div>

<!-- ===== HTML YAPISI BİREBİR – DEĞİŞMEDİ ===== -->
<!-- (Burada senin gönderdiğin HTML aynen duruyor) -->

<script>
/* =================================================
   FIREBASE – SENİN YENİ PROJEN
================================================= */
const firebaseConfig = {
  apiKey: "AIzaSyCeemwf6KRAHl4N3wMtNx-yYIgAg5P8LEs",
  authDomain: "trio-manager.firebaseapp.com",
  projectId: "trio-manager",
  storageBucket: "trio-manager.firebasestorage.app",
  messagingSenderId: "447336966368",
  appId: "1:447336966368:web:910c838ef487c7c84c8885"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const col = "trio_records";

/* =================================================
   GÜVENLİ KÜÇÜK DOKUNUŞLAR (TASARIMA DOKUNMADAN)
================================================= */
function safe(v){ return v ? String(v) : ""; }
function formatDate(d){ if(!d) return "-"; const x=new Date(d); return isNaN(x)?"-":x.toLocaleDateString('tr-TR'); }
function getDiff(d){
  if(!d) return {days:999,text:"-"};
  const t=new Date(); t.setHours(0,0,0,0);
  const diff=Math.ceil((new Date(d)-t)/86400000);
  if(diff===0) return {days:0,text:"BUGÜN"};
  if(diff===1) return {days:1,text:"YARIN"};
  if(diff<0) return {days:diff,text:"GECİKTİ"};
  return {days:diff,text:diff+" GÜN"};
}
</script>
</body>
</html>
